<!DOCTYPE html>
<html lang="ko">
<head>
  <!-- í•„ìˆ˜ ë©”íƒ€ -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì²­BTI í…ŒìŠ¤íŠ¸ ê²°ê³¼</title>

  <!-- ì£¼ì†Œì°½ í…Œë§ˆìƒ‰ -->
  <meta name="theme-color" content="#2563eb" />

  <!-- ì •ê·œí™” URL(ë°°í¬ ë„ë©”ì¸ìœ¼ë¡œ êµì²´) -->
  <link rel="canonical" href="https://example.com/result.html" />

  <!-- íŒŒë¹„ì½˜(í•„ìš”ì‹œ êµì²´) -->
  <link rel="icon" href="/favicon.ico" sizes="any" />
  <link rel="icon" href="/icon.svg" type="image/svg+xml" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

  <!-- OG/Twitter(ì •ì  í˜ì´ì§€ë¼ ê²°ê³¼ë³„ë¡œ ë°”ê¾¸ê¸° ì–´ë ¤ì›€) -->
  <meta property="og:title" content="ì²­BTI í…ŒìŠ¤íŠ¸ ê²°ê³¼" />
  <meta property="og:description" content="ë‚˜ì˜ ì²­ë‘ ìœ í˜•ì„ í™•ì¸í•˜ê³  ì¹œêµ¬ë“¤ê³¼ ê³µìœ í•˜ì„¸ìš”." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="preview.png" />
  <meta name="twitter:card" content="summary_large_image" />

  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    @media (prefers-reduced-motion: reduce) {
      .animate-bounce { animation: none !important; }
    }
    /* ê³¼í•˜ì§€ ì•Šì€ ë¡œê³  ëª¨ì…˜(ì‚´ì§ ë‘¥ì‹¤) */
    @keyframes floaty { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-6px)} }
    .logo-floaty { animation: floaty 2.8s ease-in-out infinite; }
  </style>
</head>

<body class="flex items-center justify-center min-h-screen bg-gradient-to-br from-blue-100 to-indigo-200 dark:from-neutral-900 dark:to-neutral-800 font-sans p-4">
  <div class="bg-white dark:bg-neutral-900 dark:text-neutral-100 p-8 rounded-3xl shadow-2xl w-[95%] max-w-xl text-center border-4 border-blue-300 dark:border-neutral-700">

    <!-- ë¡œê³  -->
    <div class="w-full flex flex-col items-center mb-4">
      <img src="logo.png" alt="ì²­ë‘ ë¡œê³ " class="h-16 sm:h-20 object-contain logo-floaty">
      <div class="w-10 h-1 bg-blue-400 rounded-full mt-3"></div>
    </div>

    <!-- ì¥ì‹ ì´ëª¨ì§€ -->
    <div class="text-6xl mb-4" aria-hidden="true">ğŸ’ </div>

    <!-- í˜ì´ì§€ íƒ€ì´í‹€ -->
    <h1 class="text-3xl font-extrabold text-blue-700 dark:text-blue-300 mb-6">
      ì²­BTI ê²°ê³¼ ğŸ„ğŸ»â€â™‚ï¸
    </h1>

    <!-- ê²°ê³¼ ì œëª© -->
    <div
      id="result-text"
      class="text-2xl text-gray-800 dark:text-neutral-100 font-bold mb-3"
      role="status"
      aria-live="polite"
    ></div>

    <!-- ê²°ê³¼ ì„¤ëª… -->
    <div
      id="result-desc"
      class="text-base text-gray-700 dark:text-neutral-300 leading-relaxed mb-6 whitespace-pre-line"
    ></div>

    <!-- ê²°ê³¼ ì´ë¯¸ì§€ -->
    <img
      id="result-img"
      src=""
      alt="ì²­BTI ê²°ê³¼ ì¹´ë“œ"
      loading="lazy"
      class="mx-auto w-72 sm:w-80 rounded-2xl shadow-md border-2 border-blue-200 dark:border-neutral-700 mb-4"
    />

    <!-- ì´ë¯¸ì§€ ì„¤ëª…(ì‚¬ì§„ ì•„ë˜ í…ìŠ¤íŠ¸) -->
    <div
      id="result-caption"
      class="text-sm text-gray-600 dark:text-neutral-400 italic mb-6"
    ></div>

    <!-- ë²„íŠ¼ ì˜ì—­ -->
    <div class="space-y-3">
      <button
        type="button"
        id="retakeBtn"
        class="w-full py-3 bg-blue-600 text-white text-lg font-semibold rounded-xl shadow-md hover:bg-blue-700 hover:scale-105 transition transform duration-300 focus:outline-none focus-visible:ring-4 focus-visible:ring-blue-300"
        aria-label="ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•˜ê¸°ë¡œ ì´ë™"
      >
        ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•˜ê¸° ğŸ”
      </button>

      <button
        type="button"
        id="shareBtn"
        class="w-full py-3 bg-sky-500 text-white text-lg font-semibold rounded-xl shadow-md hover:bg-sky-600 hover:scale-105 transition transform duration-300 focus:outline-none focus-visible:ring-4 focus-visible:ring-sky-300"
        aria-label="ê²°ê³¼ë¥¼ ê³µìœ í•˜ê¸°"
      >
        ê²°ê³¼ ê³µìœ í•˜ê¸° ğŸ“¤
      </button>

      <button
        type="button"
        id="copyBtn"
        class="w-full py-3 bg-gray-200 dark:bg-neutral-800 text-gray-800 dark:text-neutral-100 text-sm font-medium rounded-xl hover:bg-gray-300 dark:hover:bg-neutral-700 transition focus:outline-none focus-visible:ring-4 focus-visible:ring-gray-300"
        aria-label="ê³µìœ  ë§í¬ ë³µì‚¬"
      >
        ë§í¬ ë³µì‚¬í•˜ê¸° ğŸ”—
      </button>
    </div>

    <p id="notice" class="text-xs text-gray-500 dark:text-neutral-400 mt-4"></p>
  </div>

  <script>
    /* 0) ë‹¤í¬ëª¨ë“œ ë™ê¸°í™” */
    (function initColorScheme() {
      const mq = window.matchMedia("(prefers-color-scheme: dark)");
      document.documentElement.classList.toggle("dark", mq.matches);
      mq.addEventListener?.("change", (e) => {
        document.documentElement.classList.toggle("dark", e.matches);
      });
    })();

    /* 1) ê²°ê³¼ ì‚¬ì „ (ì´ë¯¸ì§€: first.png / second.png / third.png) */
    const RESULTS = {
      giun: {
        dept: "ê¸°íšìš´ì˜ë¶€",
        text: "ğŸ“Šë˜‘ë˜‘ì´ ìœ ìƒ",
        desc:
`ë‹¹ì‹ ì€ ì²­ë‘ì˜ ë¸Œë ˆì¸ğŸ§ 
ì „ì²´ êµ¬ì¡°ë¥¼ ì§œê³ , ì¼ì •ì„ ê´€ë¦¬í•˜ë©°, íŒì„ ì•¼ë¬´ì§€ê²Œ ì„¤ê³„í•˜ëŠ” íƒ€ì…!
â€œì´ê±° ëˆ„ê°€ ì´ê´„í•´?â€ í•˜ë©´ ìì—°ìŠ¤ëŸ½ê²Œ ë‹¹ì‹  ì´ë¦„ì´ ë‚˜ì˜¤ê² êµ°ìš”ğŸ’š`,
        img: "first.png",
        caption: "íŒì„ ì„¤ê³„í•˜ê³  íë¦„ì„ ì¡ëŠ” â€˜ê¸°ìš´â€™ íƒ€ì… ğŸ’š"
      },
      ingyeong: {
        dept: "ì¸ì‚¬ê²½ì˜ë¶€",
        text: "âš–ï¸ì¸ê°„ ì €ìš¸ ìœ ìƒ",
        desc:
`ë‹¹ì‹ ì€ ì²­ë‘ì˜ ì‹¬ì¥â¤ï¸â€ğŸ”¥
ë‹¤ë¥¸ ì‚¬ëŒì„ ì˜ ì±™ê¸°ê³  ë¶„ìœ„ê¸°ë¥¼ ì‚´í”¼ë©°, ê°ˆë“±ì´ ë°œìƒí•˜ë©´ ì²´ê³„ì ì´ê³  ê³µí‰í•˜ê²Œ ì¤‘ì¬í•˜ëŠ” íƒ€ì…!
"ë‚˜ ê³ ë¯¼ ìˆì–´" í•˜ë©´ ë‹¤ë“¤ ìì—°ìŠ¤ëŸ½ê²Œ ë‹¹ì‹ ì„ ì°¾ì„ê±°ì˜ˆìš”ğŸ’›`,
        img: "second.png",
        caption: "íŒ€ì˜ ë°¸ëŸ°ìŠ¤ë¥¼ ì§€í‚¤ëŠ” â€˜ì¸ê²½â€™ íƒ€ì… ğŸ’›"
      },
      daehong: {
        dept: "ëŒ€ì™¸í™ë³´ë¶€",
        text: "ğŸª´ì•„ì´ë””ì–´ í™”ìˆ˜ë¶„ ìœ ìƒ",
        desc:
`ë‹¹ì‹ ì€ ì²­ë‘ì˜ ì–¼êµ´ğŸ¤´
ë§ë³´ë‹¤ ì´ë¯¸ì§€ê°€ ë¹ ë¥´ê³ , íŠ¸ë Œë“œì— ëŒ€í•œ ì„¼ìŠ¤ê°€ ë›°ì–´ë‚˜ë©°, ì•„ì´ë””ì–´ê°€ ëŠì„ì—†ì´ ë‚˜ì˜¤ëŠ” í™”ìˆ˜ë¶„ íƒ€ì…!
â€œì´ê±° ì–´ë–¤ ê±° í•´?â€ë¼ëŠ” ë§ì´ ë‚˜ì˜¤ê¸°ë„ ì „ì— ì´ë¯¸ ë‹¹ì‹ ì´ ë°©í–¥í‚¤ë¥¼ ì¥ê³  ìˆë„¤ìš”ğŸ©µ`,
        img: "third.png",
        caption: "ë°˜ì‘ì„ í„°ëœ¨ë¦¬ëŠ” â€˜ëŒ€í™â€™ íƒ€ì… ğŸ©µ"
      }
    };

    const DEFAULT_RESULT = {
      dept: "ê²°ê³¼ ì¤€ë¹„ì¤‘",
      text: "ê²°ê³¼ ì¤€ë¹„ì¤‘ ğŸ’ ",
      desc: "ìœ íš¨í•œ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. í…ŒìŠ¤íŠ¸ë¥¼ ë‹¤ì‹œ ì§„í–‰í•´ì£¼ì„¸ìš”.",
      img: "first.png",
      caption: ""
    };

    /* 2) ê²°ê³¼ í‚¤ ê°€ì ¸ì˜¤ê¸°
       - ìš°ì„ ìˆœìœ„: URL ?type=giun|ingyeong|daehong > localStorage('resultKey')
       - quiz.htmlì—ì„œ ì €ì¥í•œ resultKey ì‚¬ìš©
    */
    function getResultKeyAndNormalizeURL() {
      let key = null;
      try {
        const url = new URL(location.href);
        const q = url.searchParams.get("type");
        const fromQuery = q ? q.toLowerCase().trim() : null;
        const fromStorage =
          (window.localStorage && localStorage.getItem("resultKey")) || null;

        if (fromQuery && RESULTS[fromQuery]) {
          key = fromQuery;
        } else if (fromStorage && RESULTS[fromStorage]) {
          key = fromStorage;
          if (url.searchParams.get("type") !== key) {
            url.searchParams.set("type", key);
            history.replaceState(null, "", url.toString());
          }
        }
      } catch {}
      return key;
    }

    /* 3) ì´ë¯¸ì§€ ì„ ë¡œë”© */
    (function preloadImages() {
      ["first.png", "second.png", "third.png"].forEach((src) => {
        const img = new Image();
        img.src = src;
      });
    })();

    /* 4) ë Œë” */
    function render() {
      const key = getResultKeyAndNormalizeURL();
      const data = key ? RESULTS[key] : DEFAULT_RESULT;

      const $text = document.getElementById("result-text");
      const $desc = document.getElementById("result-desc");
      const $img = document.getElementById("result-img");
      const $caption = document.getElementById("result-caption");
      const $notice = document.getElementById("notice");

      const $shareBtn = document.getElementById("shareBtn");
      const $copyBtn = document.getElementById("copyBtn");
      const $retakeBtn = document.getElementById("retakeBtn");

      $text.textContent = `${data.text} (${data.dept})`;
      $desc.textContent = data.desc;
      $img.src = data.img;
      $img.alt = `${data.dept} ê²°ê³¼ ì´ë¯¸ì§€`;
      $caption.textContent = data.caption || "";

      let failedOnce = false;
      $img.onerror = () => {
        if (failedOnce) return;
        failedOnce = true;
        $img.src = DEFAULT_RESULT.img;
      };

      // ê³µìœ  URL (type ì¿¼ë¦¬ í¬í•¨)
      const shareURL = new URL(location.href);
      if (key) shareURL.searchParams.set("type", key);

      $notice.textContent = key
        ? `ê³µìœ  ë§í¬: ${shareURL.toString()}`
        : "ìœ íš¨í•œ ê²°ê³¼ê°€ ì—†ì–´ ê¸°ë³¸ í™”ë©´ì„ í‘œì‹œí•©ë‹ˆë‹¤.";

      $retakeBtn.onclick = () => {
        location.href = "index.html";
      };

      $shareBtn.onclick = async () => {
        if ($shareBtn.disabled) return;
        $shareBtn.disabled = true;
        $shareBtn.setAttribute("aria-busy", "true");

        try {
          const shareData = {
            title: "ì²­BTI í…ŒìŠ¤íŠ¸ ê²°ê³¼",
            text: key ? `ë‚´ ì²­BTIëŠ” ${data.text} (${data.dept}) ğŸ’™` : "ì²­BTI í…ŒìŠ¤íŠ¸",
            url: shareURL.toString(),
          };

          if (navigator.share) {
            await navigator.share(shareData);
          } else {
            alert("ì›¹ ê³µìœ  ë¯¸ì§€ì› í™˜ê²½ì…ë‹ˆë‹¤. 'ë§í¬ ë³µì‚¬í•˜ê¸°'ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.");
          }
        } catch (e) {
          console.info("share failed", e);
          alert("ê³µìœ ê°€ ì·¨ì†Œë˜ì—ˆê±°ë‚˜ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        } finally {
          $shareBtn.disabled = false;
          $shareBtn.removeAttribute("aria-busy");
        }
      };

      $copyBtn.onclick = async () => {
        try {
          await navigator.clipboard.writeText(shareURL.toString());
          $notice.textContent = "ë§í¬ë¥¼ í´ë¦½ë³´ë“œì— ë³µì‚¬í–ˆìŠµë‹ˆë‹¤.";
        } catch {
          const tmp = document.createElement("textarea");
          tmp.value = shareURL.toString();
          tmp.setAttribute("readonly", "");
          tmp.style.position = "absolute";
          tmp.style.left = "-9999px";
          document.body.appendChild(tmp);
          tmp.select();
          document.execCommand("copy");
          document.body.removeChild(tmp);
          $notice.textContent = "ë§í¬ë¥¼ ë³µì‚¬í–ˆìŠµë‹ˆë‹¤.";
        }
      };
    }

    render();
  </script>
</body>
</html>
